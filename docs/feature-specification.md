# 华为云智能编排平台 — 特性说明书

> 版本：v1.0
> 更新日期：2026-02-13

---

## 1. 产品概述

华为云智能编排平台（Huawei Cloud Agent Orchestrator）是一款基于大语言模型的云资源自动化编排系统。用户通过自然语言描述基础设施需求，系统自动完成需求分析、架构规划、工作流生成与执行，实现云资源的一键部署。

---

## 2. 核心特性

### 2.1 自然语言驱动的工作流生成

**描述**：用户以自然语言输入基础设施需求，系统通过 LLM 四阶段流水线自动生成可执行的工作流定义。

**处理流程**：

| 阶段 | 名称 | 说明 |
|------|------|------|
| Stage 0 | 架构规划 | LLM 分析需求，输出部署模式、DFX 等级、所需服务及依赖关系 |
| Stage 1 | 语义检索 | 基于向量数据库检索相关 API 操作及参数定义 |
| Stage 2 | 模板匹配 | 匹配预定义参数模板，为 LLM 提供精确的参数结构示例 |
| Stage 3 | 工作流生成 | LLM 综合所有上下文生成完整的工作流 JSON |

**支持的部署模式**：
- 单机部署（single）
- 高可用部署（ha）
- 集群部署（cluster）
- 无服务器部署（serverless）

**输入示例**：
```
部署一个 Web 应用，包含 VPC、2 台 ECS、负载均衡和 MySQL 数据库
```

**输出**：包含任务定义、依赖关系、参数配置的完整工作流 JSON。

---

### 2.2 工作流校验与自动纠错

**描述**：生成的工作流经过服务注册表校验，自动修正常见错误，并通过 LLM 反馈循环修复复杂问题。

**校验内容**：
- 服务名称是否存在于注册表
- 操作名称是否属于对应服务
- 参数结构是否符合 API 规范

**纠错机制**：
- 自动纠错：大小写不匹配、模糊匹配修正
- LLM 纠错：将校验错误反馈给 LLM，最多重试 2 次，采用指数退避策略

---

### 2.3 可视化工作流设计器

**描述**：提供拖拽式图形界面，支持手动构建和编辑工作流。

**功能**：
- 节点拖拽与连接
- 依赖关系可视化
- 参数编辑与变量引用
- 工作流实时校验
- 导入/导出工作流 JSON

---

### 2.4 智能工作流执行引擎

**描述**：基于拓扑排序的任务调度引擎，支持依赖管理、错误重试和实时状态追踪。

**核心能力**：

| 能力 | 说明 |
|------|------|
| 依赖解析 | 拓扑排序算法，自动检测循环依赖 |
| 参数替换 | 支持 `{{ variables.* }}` 和 `{{ outputs.task_name.* }}` 模板语法 |
| 错误重试 | 可配置最大重试次数，指数退避（2^n 秒） |
| 状态管理 | 任务状态机：PENDING → RUNNING → SUCCESS / FAILED / SKIPPED / TIMEOUT |
| Dry Run | 验证模式，不实际执行 API 调用 |

**执行状态判定**：
- 全部成功 → SUCCESS
- 部分成功 → PARTIAL_SUCCESS
- 全部失败 → FAILED

---

### 2.5 华为云服务全覆盖

**描述**：通过动态 SDK 导入机制，支持 190+ 华为云服务的 API 调用。

**支持的服务类别**：

| 类别 | 服务 |
|------|------|
| 计算 | ECS、CCE、BMS、FunctionGraph、DCS |
| 网络 | VPC、ELB、NAT Gateway、VPN、DNS、CDN |
| 存储 | OBS、EVS、SFS Turbo |
| 数据库 | RDS、GaussDB、DDS |
| 安全 | IAM、WAF、KMS、DDoS 防护、SSL 证书 |
| 监控运维 | CES、LTS、CTS、SMN、APM |
| AI/ML | ModelArts、DLI |
| 其他 | 190+ 服务全覆盖 |

**动态客户端创建**：
- 运行时动态导入 SDK 模块
- 自动构建请求对象（snake_case → PascalCase 转换）
- 统一的认证与区域管理

---

### 2.6 语义化 API 检索

**描述**：基于 ChromaDB 向量数据库，支持对华为云 API 操作的语义搜索。

**检索模式**：
- 精确检索：按服务名 + 操作名定向查询
- 语义检索：基于自然语言描述的相似度搜索
- 服务过滤：限定特定服务范围内检索

**数据结构**：每条操作记录包含服务名、操作名、描述、输入/输出参数定义，构建为完整文档用于 Embedding。

---

### 2.7 多 LLM 提供商支持

**描述**：统一的 LLM 客户端抽象层，支持多种模型提供商无缝切换。

| 提供商 | 说明 |
|--------|------|
| Anthropic | Claude 系列模型 |
| OpenAI | GPT 系列模型 |
| Custom | 任意 OpenAI 兼容接口（如私有化部署模型） |

**附加能力**：
- 五级 JSON 修复流水线（直接解析 → 尾逗号修复 → 括号修复 → 截断修复 → json_repair 库）
- Markdown 代码块自动提取
- 可配置 max_tokens、temperature 等参数

---

### 2.8 规则引擎降级

**描述**：当 LLM 不可用或调用失败时，自动降级为基于规则的工作流生成。

**内置模板**：
- Web 应用部署（VPC + Subnet + SecurityGroup + ECS）
- 高可用 Web 部署（VPC + ECS×2 + ELB + EIP + RDS）
- 单 ECS 创建
- VPC 网络创建
- RDS 数据库创建
- OBS 存储桶创建
- CCE 容器集群创建
- WAF 安全策略
- CES 监控告警
- GaussDB 数据库创建

**参数提取**：通过正则表达式从自然语言中提取名称、规格、CIDR 等配置参数。

---

### 2.9 工作流历史管理

**描述**：持久化存储所有生成和执行的工作流记录，支持查询、回放和删除。

**存储内容**：
- 用户原始需求
- 工作流名称与描述
- 完整工作流 JSON
- 任务数量与涉及服务
- 生成状态与时间戳

**操作**：分页查询、单条详情查看、删除记录。

---

### 2.10 Web 管理界面

**描述**：完整的 Web UI，覆盖工作流全生命周期管理。

| 页面 | 路径 | 功能 |
|------|------|------|
| 首页 | `/` | 自然语言输入与工作流生成 |
| 工作流设计器 | `/designer` | 可视化拖拽设计 |
| 智能生成 | `/auto` | AI 自动生成 + 执行 + 解释 |
| 服务列表 | `/services` | 浏览所有可用云服务与操作 |
| 执行监控 | `/monitor` | 实时执行状态追踪 |
| 历史记录 | `/history` | 工作流历史管理 |
| 设置 | `/settings` | LLM、华为云凭证、Prompt 模板配置 |

---

### 2.11 认证与会话管理

**描述**：基于 Session 的用户认证系统，保护所有 API 和页面访问。

- SHA-256 密码哈希
- 签名 Cookie 会话（24 小时 TTL）
- 中间件级别的请求拦截
- API 请求返回 401 JSON，页面请求重定向到登录页

---

### 2.12 灵活的配置管理

**描述**：YAML 文件 + 环境变量 + Web 界面三级配置体系。

**可配置项**：
- LLM 提供商、API Key、模型、温度等参数
- 华为云 AK/SK、Region、Project ID
- 工作流最大并发数、超时时间、重试策略
- Prompt 模板自定义
- 服务器地址与端口

**运行时热更新**：通过 Web 界面修改配置后即时生效，无需重启服务。
